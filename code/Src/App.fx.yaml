App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =If(
            LookUp(
                Users_1,
                email = User().Email,
                userRole
            ) = "admin",
            Set(
                is_admin,
                true
            ),
            Set(
                is_admin,
                false
            )
        );
        Set(
            userData,
            {
                firstName: LookUp(
                    Users_1,
                    email = User().Email,
                    firstName
                ),
                lastName: LookUp(
                    Users_1,
                    email = User().Email,
                    lastName
                ),
                email: User().Email,
                role: LookUp(
                    Users_1,
                    email = User().Email,
                    userRole
                ),
                id: LookUp(
                    Users_1,
                    email = User().Email,
                    ID
                )
            }
        );
        //Enable for non timer based navigation for Splash Screen
        //Set(splashNavigate,true)
        ClearCollect(
            colStatus,
            {Result: "open"},
            {Result: "closed"}
        );
        //split admin tech later
        ClearCollect(
            navCol,
            {
                ID: 2,
                NavName: "Create Ticket",
                NavIcon: Icon.AddDocument,
                ScreenToGoTo: 'Category Select',
                AdminTech: true,
                Staff: true
            },
            {
                ID: 3,
                NavName: "My Tickets",
                NavIcon: Icon.Folder,
                ScreenToGoTo: MyTickets,
                AdminTech: true,
                Staff: true
            },
            {
                ID: 5,
                NavName: "Admin Manager",
                NavIcon: Icon.ComputerDesktop,
                ScreenToGoTo: 'Admin Manager',
                AdminTech: true,
                Staff: false
            },
            {
                ID: 6,
                NavName: "Knowledge Base",
                NavIcon: Icon.QuestionMark,
                ScreenToGoTo: 'Knowledge Base',
                AdminTech: true,
                Staff: true
            }
        );
        Set(
            NDrop,
            false
        );
        Set(
            MGallery,
            false
        );
        Set(
            HambIconChange,
            false
        );
        Set(
            CloseAlertRibbon,
            false
        );
        Set(
            gblNavItems,
            Table(
                {
                    MenuText: "Home",
                    MenuIcon: Icon.Home,
                    ScreenToGoTo: Home
                },
                {
                    MenuText: "Create Ticket",
                    MenuIcon: Icon.AddDocument,
                    ScreenToGoTo: 'Category Select'
                },
                {
                    MenuText: "My Tickets",
                    MenuIcon: Icon.Folder,
                    ScreenToGoTo: MyTickets
                },
                {
                    MenuText: "Ticket Log",
                    MenuIcon: Icon.DocumentWithContent,
                    ScreenToGoTo: 'Log of All Tickets - Admin Tech'
                },
                {
                    MenuText: "Settings",
                    MenuIcon: Icon.Settings,
                    ScreenToGoTo: 'Admin Manager'
                }
            )
        );
        Set(
            ColorScheme,
            {
                primary: RGBA(
                    53,
                    89,
                    137,
                    1
                ),
                secondary: RGBA(
                    126,
                    149,
                    180,
                    1
                ),
                backgroundDark: RGBA(
                    124,
                    134,
                    137,
                    1
                ),
                offColor: RGBA(
                    219,
                    199,
                    175,
                    1
                ),
                orange: RGBA(
                    246,
                    149,
                    43,
                    1
                ),
                screenBackground: RGBA(
                    227,
                    234,
                    243,
                    1
                ),
                secondaryPressedColor: RGBA(
                    126,
                    149,
                    180,
                    .35
                )
            }
        );
        Set(
            MainCategory,
            Filter(
                Category_1,
                parentId = Blank()
            )
        );
        //only main categories. those that dont rely on a parent
        // Passed to filter component to check if filter is visible
        Set(
            varFilterVisible,
            false
        );
        ClearCollect(
            colTags,
            {Value: "None"}
        );
        Collect(
            colTags,
            ForAll(
                Sort(
                    Tags_1,
                    name,
                    SortOrder.Ascending
                ),
                {Value: ThisRecord.name}
            )
        );
        // Passed variable to check if search bar should be visible
        Set(
            varSearchVisible,
            false
        );
        // Variables used for searching and filtering in components for the power automate flow
        Set(
            StatusChoice,
            "open"
        );
        Set(
            TagChoice,
            "None"
        );
        Set(
            SearchQuery,
            ""
        );
        
        ClearCollect(
            dummyArticles,
            {
                ArticleFileName: "1021203.txt",
                ArticleTags: "Hardware, Mobile"
            },
            {
                ArticleFileName: "EDefender_Intro.docx",
                ArticleTags: "EDefender"
            },
            {
                ArticleFileName: "RemoteLogin.PDF",
                ArticleTags: "Software, Login, Remote"
            }
        );
        Set(
            titleText,
            {
                desktopSize: 20,
                mobileSize: 13,
                boldness: FontWeight.Normal
            }
        )
    StartScreen: ='Splash Screen'

